{"version":3,"sources":["components/CardView.tsx","utilities/gsx.ts","DataViewTab.tsx","components/TabSidebar.tsx","components/Loading.tsx","BetterSheetApp.tsx","serviceWorker.ts","index.tsx"],"names":["CardView","props","isLoading","headerContent","rowDatas","react_default","a","createElement","className","Card","Group","centered","doubling","map","rowData","index","key","fluid","Content","Table","definition","Body","name","Row","Cell","width","defaultProps","getStringFromRawObject","title","$t","getRowDataFromWorksheetEntries","entries","entry","Object","keys","filter","indexOf","forEach","headerName","substring","content","DataView","worksheet","infos","_React$useState","React","useState","_React$useState2","slicedToArray","setIsLoading","_React$useState3","_React$useState4","setRowDatas","useEffect","fetch","link","then","response","json","result","feed","error","Header","as","textAlign","dividing","undefined","Segment","react_markdown_default","source","src_components_CardView","TabSidebar","tabMenuItems","linkMenuItems","mobileSidebarVisible","setMobileSidebarVisible","ActiveIndex","setActiveIndex","handelMenuItemClick","event","data","menuItems","Fragment","Menu","Item","header","menuItem","active","onClick","icon","Icon","Divider","horizontal","href","target","tabPanel","Grid","Column","panel","columns","only","Sidebar","Pushable","vertical","animation","color","onHide","visible","Pusher","dimmed","borderless","compact","fixed","size","inverted","fitted","pointing","secondary","Loading","children","react_spinners","loading","sizeUnit","defaultSettings","links","defaultSettingData","attribute","arguments1","arguments2","BetterSheetApp","setTitle","_React$useState5","_React$useState6","settings","setSettings","_React$useState7","_React$useState8","worksheets","setWorksheets","getWorksheetDataFromEntries","sheetTitle","sheetLink","find","test","rel","concat","getWorksheetLink","push","rawSettings","rawSetting","assign","objectSpread","sheetID","URLSearchParams","window","location","search","get","apiQuery","apiUrl","displayTitle","document","src_components_Loading","src_components_TabSidebar","src_DataViewTab","Boolean","hostname","match","ReactDOM","render","src_BetterSheetApp_0","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.7a14b569.chunk.js","sourcesContent":["import React from 'react';\n\nimport './CardView.scss';\n\nimport { Card, Table } from 'semantic-ui-react';\n\nimport { RowData } from '../interface/app';\n\ninterface CardViewProps {\n  isLoading: boolean,\n  headerContent: string[],\n  rowDatas: RowData[]\n};\n\nconst CardView: React.FunctionComponent<CardViewProps> = (props) => {\n  const { isLoading, headerContent, rowDatas } = props;\n  return (\n    <div className='card-view'>\n      <Card.Group centered doubling>\n        {isLoading ? '' : rowDatas.map((rowData, index) => {\n          return (\n            <Card key={index} fluid>\n              <Card.Content>\n                <Table definition>\n                  <Table.Body>\n                    {headerContent.map((name, index) => {\n                      return (\n                        <Table.Row key={index} >\n                          <Table.Cell width={4}>{name}</Table.Cell>\n                          <Table.Cell>{rowData[name]}</Table.Cell>\n                        </Table.Row>\n                      )\n                    })}\n                  </Table.Body>\n                </Table>\n              </Card.Content>\n            </Card>\n          )\n        })}\n      </Card.Group>\n    </div>\n  );\n}\n\nCardView.defaultProps = {\n  isLoading: false,\n  headerContent: [],\n  rowDatas: []\n}\n\nexport default CardView;\n","import { SheetRawObject, WorksheetCellEntry } from '../interface/gsx';\nimport { RowData } from '../interface/app';\n\nexport function getStringFromRawObject(title: SheetRawObject): string {\n  return (title && title.$t) ? title.$t : '';\n}\n\nexport function getRowDataFromWorksheetEntries(entries: WorksheetCellEntry[]): RowData[] {\n  return entries.map((entry: WorksheetCellEntry): RowData => {\n    let rowData: RowData = {};\n    Object.keys(entry)\n      .filter(key => (key.indexOf('gsx$') > -1))\n      .forEach((key: string): void => {\n        const headerName = key.substring(4);\n        const content = getStringFromRawObject(entry[key]);\n        rowData[headerName] = content;\n      });\n    return rowData;\n  });\n}\n","import React from 'react';\n\nimport { Header, Segment } from 'semantic-ui-react';\nimport ReactMarkdown from 'react-markdown';\nimport CardView from './components/CardView';\n\nimport './DataViewTab.scss';\nimport 'github-markdown-css'\n\nimport { getRowDataFromWorksheetEntries } from './utilities/gsx';\n\nimport { RowData } from './interface/app';\n\ninterface DataViewProps {\n  worksheet: {\n    title: string,\n    link: string\n  }\n  infos: string\n};\n\nconst DataView: React.FunctionComponent<DataViewProps> = (props) => {\n  const { worksheet, infos } = props;\n\n  // const [isError, setIsError] = useState<boolean>(false);\n  const [isLoading, setIsLoading] = React.useState<boolean>(true);\n  const [rowDatas, setRowDatas] = React.useState<RowData[]>([]);\n\n  React.useEffect(() => {\n    fetch(worksheet.link)\n      .then(response => response.json())\n      .then((result) => {\n        if (result.feed.entry) {\n          setRowDatas(getRowDataFromWorksheetEntries(result.feed.entry));\n          setIsLoading(false);\n        }\n      }, (error) => {\n        // setIsError(true);\n      });\n  }, [worksheet]);\n\n  return (\n    <div className='data-view-tab'>\n      <Header as='h1' textAlign='center' dividing>{worksheet.title}</Header>\n      {\n        (infos !== '' && infos !== undefined) ? (\n          <Segment className=\"markdown-body\">\n            <ReactMarkdown source={infos} />\n          </Segment>\n        ) : null\n      }\n      <CardView\n        isLoading={isLoading}\n        headerContent={Object.keys(rowDatas[0] || {})}\n        rowDatas={rowDatas}\n      />\n    </div>\n  );\n}\n\nexport default DataView;\n","import React from 'react';\n\nimport './TabSidebar.scss';\n\nimport { Sidebar, Grid, Menu, Icon, Divider, Header } from 'semantic-ui-react';\n\nimport { MenuItems } from '../interface/app';\n\ninterface TabSidebarProps {\n  title: string,\n  tabMenuItems: MenuItems[],\n  linkMenuItems: MenuItems[],\n};\n\nconst TabSidebar: React.FunctionComponent<TabSidebarProps> = (props) => {\n  const { title, tabMenuItems, linkMenuItems } = props;\n\n  const [mobileSidebarVisible, setMobileSidebarVisible] = React.useState<boolean>(false);\n\n  const [ActiveIndex, setActiveIndex] = React.useState<number>(0);\n  const handelMenuItemClick = (event: React.SyntheticEvent, data: any) => {\n    setActiveIndex(data['index']);\n    setMobileSidebarVisible(false);\n  }\n\n  const menuItems = (<React.Fragment>\n    <Menu.Item header>{title}</Menu.Item>\n    {tabMenuItems.map((menuItem, index) => (\n      <Menu.Item key={index}\n        index={index} active={ActiveIndex === index}\n        onClick={handelMenuItemClick} icon\n      ><Icon name='table'></Icon>\n        {menuItem.name}\n      </Menu.Item>\n    ))}\n    <Divider horizontal><Header as='h6'>Links</Header></Divider>\n    {linkMenuItems.map((menuItem, index) => (\n      <Menu.Item key={index} icon as='a' href={menuItem.href} target='__blank'>\n        <Icon name='external alternate'></Icon>\n        {menuItem.name}\n      </Menu.Item>\n    ))}\n  </React.Fragment>);\n\n  const tabPanel = (<Grid>\n    {tabMenuItems.map((menuItems, index) =>\n      <Grid.Column key={index} className={(ActiveIndex === index) ? '' : 'hidden'}>\n        {menuItems.panel}\n      </Grid.Column>\n    )}\n  </Grid>);\n\n  return (<Grid>\n    <Grid.Row columns={1} only='mobile tablet'>\n      <Sidebar.Pushable as={Grid.Column} className='mobile-sidebar-container'>\n        <Sidebar\n          as={Menu} vertical animation='overlay' color='blue'\n          onHide={() => setMobileSidebarVisible(false)} visible={mobileSidebarVisible}\n        >{menuItems}\n        </Sidebar>\n        <Sidebar.Pusher dimmed={mobileSidebarVisible}>\n          <Menu borderless compact fixed='left' size='small' inverted color='blue'>\n            <Menu.Item\n              className='mobile-sidebar-toggle'\n              onClick={() => setMobileSidebarVisible(true)}\n            ><Icon fitted name='sidebar'></Icon>\n            </Menu.Item>\n          </Menu>\n          {tabPanel}\n        </Sidebar.Pusher>\n      </Sidebar.Pushable>\n    </Grid.Row>\n    <Grid.Row columns={1} only='computer'>\n      <Sidebar.Pushable as={Grid.Column} className='computer-sidebar-container'>\n        <Menu vertical fixed='left' pointing secondary color='blue'\n        >{menuItems}\n        </Menu>\n        <Sidebar.Pusher>\n          {tabPanel}\n        </Sidebar.Pusher>\n      </Sidebar.Pushable>\n    </Grid.Row>\n  </Grid>);\n}\n\nexport default TabSidebar;\n","import React from 'react';\n\nimport './Loading.scss';\n\nimport { Header } from 'semantic-ui-react';\nimport { ClipLoader } from 'react-spinners';\n\ninterface LoadingProps {\n  isLoading: boolean\n};\n\nconst Loading: React.FunctionComponent<LoadingProps> = (props) => {\n  const { isLoading, children } = props;\n  const color = '#4A90E2';\n\n  return <React.Fragment>\n    {isLoading ? (\n      <div className='loading-container'>\n        <ClipLoader\n          loading={isLoading} color={color}\n          sizeUnit={'px'} size={100}\n        />\n        <Header className='loading-text' textAlign='center'>Loading Data...</Header>\n      </div>\n    ) : children}\n  </React.Fragment>;\n}\n\nLoading.defaultProps = {\n  isLoading: true\n}\n\nexport default Loading;\n","import React from 'react';\n\nimport './static/semantic/semantic.min.css';\nimport './BetterSheetApp.scss';\n\nimport DataViewTab from './DataViewTab';\nimport TabSidebar from './components/TabSidebar';\nimport Loading from './components/Loading';\n\nimport { getStringFromRawObject, getRowDataFromWorksheetEntries } from './utilities/gsx';\n\nimport { WorksheetLink, WorksheetEntry } from './interface/gsx';\nimport { RowData, WorksheetData, Settings } from './interface/app';\n\nconst defaultSettings: Settings = { title: '', links: [], infos: {} };\nconst defaultSettingData: RowData = { attribute: '', arguments1: '', arguments2: '' };\n\nconst BetterSheetApp: React.FunctionComponent<{}> = () => {\n  const [isLoading, setIsLoading] = React.useState<boolean>(true);\n  const [title, setTitle] = React.useState<string>('');\n  const [settings, setSettings] = React.useState<Settings>(defaultSettings);\n  const [worksheets, setWorksheets] = React.useState<WorksheetData[]>([]);\n\n  React.useEffect(() => {\n    const getSettingsFromWorksheet = (WorksheetUrl: string) => {\n      fetch(WorksheetUrl)\n        .then(response => response.json())\n        .then((result) => {\n          if (result && result.feed && result.feed.title && result.feed.entry) {\n            let rawSettings: Settings = defaultSettings;\n            getRowDataFromWorksheetEntries(result.feed.entry).forEach(\n              (rowData: RowData) => {\n                const rawSetting = Object.assign(defaultSettingData, rowData);\n\n                if (rawSetting.attribute === 'title') {\n                  rawSettings.title = rawSetting.arguments1;\n                }\n\n                if (rawSetting.attribute === 'links' && rawSetting.arguments1 !== '') {\n                  rawSettings.links.push({\n                    name: rawSetting.arguments1,\n                    href: rawSetting.arguments2\n                  });\n                }\n\n                if (rawSetting.attribute === 'infos' && rawSetting.arguments1 !== '') {\n                  rawSettings.infos[rawSetting.arguments1] = rawSetting.arguments2;\n                }\n              }\n            );\n            setSettings({ ...rawSettings });\n          }\n        }, (error) => {\n          // setIsError(true);\n        });\n    }\n\n    const getWorksheetLink = (links: WorksheetLink[], target: RegExp): string => {\n      const link: WorksheetLink | undefined = links.find(link => target.test(link.rel));\n      return link ? `${link.href}?alt=json` : '';\n    }\n\n    const getWorksheetDataFromEntries = (entries: WorksheetEntry[]): WorksheetData[] => {\n      let worksheets: WorksheetData[] = [];\n      entries.forEach((entry: WorksheetEntry) => {\n        const sheetTitle = getStringFromRawObject(entry.title);\n        const sheetLink = getWorksheetLink(entry.link, /#listfeed/);\n\n        if (sheetTitle === '' || sheetLink === '') { return; }\n        if (sheetTitle === 'Settings') { getSettingsFromWorksheet(sheetLink); return; }\n\n        worksheets.push({ title: sheetTitle, link: sheetLink });\n      });\n      return worksheets;\n    }\n\n    const urlParams: URLSearchParams = new URLSearchParams(window.location.search);\n    let sheetID: string = urlParams.get('sheetid') || '';\n\n    if (sheetID === '') {\n      // setIsError(true);\n      return\n    }\n\n    const apidomain: string = 'https://spreadsheets.google.com';\n    const apiQuery: string = `feeds/worksheets/${sheetID}/public/values?alt=json`;\n    const apiUrl: string = `${apidomain}/${apiQuery}`;\n\n    fetch(apiUrl)\n      .then(response => response.json())\n      .then((result) => {\n        if (result && result.feed && result.feed.title && result.feed.entry) {\n          setTitle(getStringFromRawObject(result.feed.title));\n          setWorksheets(getWorksheetDataFromEntries(result.feed.entry));\n          setIsLoading(false);\n        }\n      }, (error) => {\n        // setIsError(true);\n      });\n  }, []);\n\n  const displayTitle = settings.title || title;\n  document.title = (displayTitle) ? `${displayTitle} - BetterSheet` : 'BetterSheet';\n\n  return (\n    <Loading isLoading={isLoading} >\n      <TabSidebar\n        title={displayTitle}\n        tabMenuItems={worksheets.map((worksheet) => ({\n          name: worksheet.title,\n          panel: (\n            <DataViewTab\n              worksheet={worksheet}\n              infos={settings.infos[worksheet.title]}\n            />\n          )\n        }))}\n        linkMenuItems={settings.links} />\n    </Loading>\n  );\n}\n\nexport default BetterSheetApp;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // 'Content is cached for offline use.' message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import 'react-app-polyfill/ie11'\nimport 'react-app-polyfill/stable'\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport 'normalize.css';\nimport './index.scss';\n\nimport BetterSheetApp from './BetterSheetApp';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<BetterSheetApp />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}